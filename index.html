<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Game Undercover - Final Deluxe!</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <div class="title-header">
            <h1>🕵️ Game Undercover - Final Deluxe! 🕵️‍♀️</h1>
            <button id="toggle-music-btn" title="Putar/Hentikan Musik">🎵</button>
        </div>

        <div id="initial-config-section">
            <h2>⚙️ Pengaturan Awal Permainan</h2>
            <div class="config-grid">
                <div class="config-item">
                    <label for="total-players-config">Total Pemain:</label>
                    <input type="number" id="total-players-config" min="3" max="15" value="3">
                </div>
                <div class="config-item">
                    <label for="civilians-config">Civilian:</label>
                    <input type="number" id="civilians-config" min="1" value="1">
                </div>
                <div class="config-item">
                    <label for="undercovers-config">Undercover:</label>
                    <input type="number" id="undercovers-config" min="0" value="1">
                </div>
                <div class="config-item">
                    <label for="mrwhites-config">Mr. White:</label>
                    <input type="number" id="mrwhites-config" min="0" value="1">
                </div>
            </div>
            <button id="proceed-to-card-distribution-btn">➡️ Lanjut ke Sesi Pembagian Kartu</button>
            <p id="config-error" class="error-message hidden"></p>
        </div>

        <div id="player-name-input-section" class="hidden">
            <h2 id="player-name-input-title">👤 Masukkan Nama Pemain X</h2>
            <label for="current-player-name-input">Nama Anda:</label>
            <input type="text" id="current-player-name-input" placeholder="Nama Pemain">
            <button id="submit-name-and-draw-card-btn">✔️ Simpan Nama & Ambil Kartu</button>
        </div>
        
        <div id="card-reveal-modal" class="modal hidden">
            <div class="modal-content card-modal-content">
                <h3 id="card-reveal-popup-title">Ambil Kartu Anda, [Nama Pemain]!</h3>
                <div class="card-scene">
                    <div class="card" id="role-card">
                        <div class="card-face card-back">
                            <div class="card-back-design">
                                <span>?</span>
                            </div>
                            <p>SENTUH KARTU UNTUK MEMBALIK</p>
                        </div>
                        <div class="card-face card-front">
                            <h4 class="card-role-title">Peran Anda:</h4>
                            <p id="card-player-role" class="card-role-text"></p>
                            <h4 class="card-word-title">Kata Rahasia:</h4>
                            <p id="card-player-word" class="card-word-text"></p>
                        </div>
                    </div>
                </div>
                <button id="hide-card-and-proceed-btn" class="hidden">🙈 Sembunyikan Kartu & Lanjut</button>
            </div>
        </div>

        <div id="game-section" class="hidden">
            <h2>🧑‍🤝‍🧑 Pemain Aktif Babak Ini:</h2>
            <ul id="active-player-list" class="player-avatar-grid"> 
                </ul>
            <p id="debug-civilian-word" style="display:none;">Kata Civilian: <em id="civilian-word-display">(Debug)</em></p>
            
            <div id="discussion-phase">
                </div>

            <div id="voting-phase"> 
                <h3>🗳️ Konfirmasi Eliminasi</h3>
                <p>Pemain yang dipilih untuk dieliminasi: <strong id="player-to-eliminate-display">Belum ada</strong></p>
                <button id="confirm-elimination-btn" disabled>🔪 Konfirmasi Eliminasi Pilihan</button>
            </div>

            <div id="elimination-result-popup" class="modal hidden"> 
                <div class="modal-content elimination-popup-content">
                    <h3 id="eliminated-player-info"></h3>
                    <div id="truth-or-dare-section"> 
                        <p>Silakan pilih hukuman untuk yang tereliminasi:</p>
                        <button id="truth-btn">😇 Truth</button>
                        <button id="dare-btn">😈 Dare</button>
                        <div id="penalty-display" class="hidden">
                            <p id="penalty-text"></p>
                        </div>
                    </div>
                    <button id="close-elimination-popup-btn" class="hidden">➡️ Lanjut</button>
                </div>
            </div>

            <div id="mr-white-guess-section" class="hidden">
                <h3>🚨 Mr. White Teridentifikasi! 🚨</h3>
                <p><strong id="mr-white-name-guess"></strong>, Anda punya satu kesempatan untuk menebak kata rahasia Civilian:</p>
                <input type="text" id="mr-white-word-guess-input" placeholder="Ketik tebakan kata Civilian">
                <button id="submit-mr-white-guess-btn">✅ Kirim Tebakan</button>
            </div>
        </div>

        <div id="winner-popup-modal" class="modal hidden">
            <div class="modal-content">
                <span class="close-popup-btn">&times;</span>
                <h2 id="popup-winner-message">🎉 Selamat! 🎉</h2>
                <p id="popup-winner-detail"></p>
                <button id="proceed-to-round-scores-btn">Lanjut ke Skor Babak</button>
            </div>
        </div>


        <div id="round-over-section" class="hidden">
            <h2 id="round-over-title">🏁 Babak Selesai! 🏁</h2>
            <div id="round-summary">
                <div id="round-roles-section">
                    <h3>📜 Detail Peran Babak Ini:</h3>
                    <ul id="round-roles-list"></ul>
                </div>
                <div id="round-scoring-section">
                    <h3>📊 Skor Babak Ini (Ditambahkan ke Total):</h3>
                    <ul id="round-player-scores-list"></ul>
                </div>
            </div>
            <div id="next-actions-section">
                <button id="play-new-round-btn">🔁 Mainkan Babak Baru (Tim Sama)</button>
                <button id="finish-game-show-final-scores-btn">🛑 Selesai & Lihat Skor Akhir</button>
                <button id="restart-game-full-btn">⏪ Ulang Dari Awal (Tim & Skor Baru)</button>
            </div>
        </div>

        <div id="final-score-display-section" class="modal hidden">
             <div class="modal-content">
                <span class="close-final-score-btn">&times;</span>
                <h2>🏆 Skor Akhir Permainan 🏆</h2>
                <ul id="final-cumulative-scores-list">
                    </ul>
                <button id="restart-from-final-btn">⏪ Ulang Dari Awal</button>
            </div>
        </div>
    </div>
    <audio id="background-music" loop></audio> <script src="script.js"></script>
</body>
</html>